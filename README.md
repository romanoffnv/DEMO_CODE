## Описание
Эта программа разработана в целях презентации и представляет собой информационную панель с графическим интерфейсом. Управление информационной панелью осуществляется пользователем. Программа производит анализ данных, полученных из трех источников, и визуализирует графическое представление определенных метрик.

## Архитектура
ROOT   
|-__init__.py \
|- DC_settings.py \
|- main.py <br>

NOTEBOOKS \
|--- validator.ipynb

PROCESSOR \
|--- _main.py <br>
|--- plates_parser.py <br>
|--- src_xlsx_get <br>
|--- src1_api_get.py <br>
|--- src1_api_parse.py <br>
|--- src2_ops_parse.py <br>
|--- src3_drvs_parse.py <br>
|--- src3_drvs_validator.py <br>
|--- uniplates.py <br>
|--- user_report.py <br>

GUI \
|--- GUI/_main.py \
|--- GUI/_main.py/button_field.py \
|--- GUI/_main.py/screen_field.py \
|--- GUI/_main.py/warning_field.py <br>

SRC \
|--- DEMO_CODE_dispatch.xlsx \
|--- DEMO_CODE_drivers.xlsx \
|--- database.db <br>

## Карта взаимодействия модулей
ROOT
1. main.py -> PROCESSOR/_main.py<br>
2. main.py -> GUI/_main.py<br>

PROCESSOR
1. _main.py -> src1_api_get.py -> _main.py -> src1_api_parse.py -> _main.py
2. _main.py -> src_xlsx_get -> _main.py -> src2_ops_parse.py -> plates_parser.py -> src2_ops_parse.py -> _main.py
3. _main.py -> src_xlsx_get -> _main.py -> src3_drvs_parse.py -> plates_parser.py -> src3_drvs_parse.p -> _main.py
4. _main.py -> src3_drvs_validator.py -> _main.py
5. _main.py -> uniplates.py -> _main.py
6. _main.py -> user_report.py -> _main.py
 
## Описание модулей
### ROOT
#### __init__.py
Это общий модуль для всего проекта, в котором размещены все импорты используемых библиотек
#### DC_settings.py
В этом модуле находятся: <br>
1. Функционал работы с базой данных SQL lite. Коннект к базе, создание, удаление таблиц, выгрузка данных в БД, выгрузка данных из БД <br>
2. Параметры просмотра пандовских датафреймов в консоли <br>
3. Некоторые часто используемые функции при работе с датафреймами <br>
#### main.py
main.py это главный модуль, который запускает 2 основных компонента программы. PROCESSOR и GUI, через контроллеры этих компонентов _main.py 
#### .gitattributes
В этом файле системы LFS прописаны файлы больших размеров, которые не выкладываются в github.com с каждым коммитом, а находятся в выделенном месте на сервере, что позволяет экономить место.

### NOTEBOOKS 
В этой папке находятся файлы Jupyter Notebook, предназначенные для модулей, которые требуют графического представления данных. 
### PROCESSOR
#### _main.py
_main.py управляет всеми процессами компонента PROCESSOR, связанными с извлечением данных из источников, преобразованием, валидацией и размещением в БД
#### plates_parser.py 
Общий модуль для компонента PROCESSOR, принимает список данных, далее извлекает номерные знаки автомобилей при помощи универсального регулярного выражения.
#### src_xlsx_get.py
Модуль принимает название источника в формате xlsx, присвоенное переменной fname в файле _main.py. Функция принимает путь до папки SRC и название источника, далее перебирает все файлы в папке SRC, если находит требуемый файл, открывает его и возвращает в формате датафрейма.
#### src1_api_get.py
Модуль подключается к веб-ресурсу <i>github.com</i> через API и извлекает данные в формате JSON. Файл не сохраняется на локальной машине, а обрабатывается непосредственно в процессе выполнения программы, в режиме реального времени.
#### src1_api_parse.py
Модуль принимает данные, полученные в <b>src1_api_get.py</b>, распределяет их по соответствующим спискам. Из сформированных списков создает датафрейм и возвращает его в _main.py
#### src2_ops_parse.py
Модуль принимает данные, полученные в <b>src_xlsx_get.py</b>, в виде датафрейма. Так как источник является оперативной сводкой, предназначенной больше для визуального представления данных, чем для проведения аналитики, функционал модуля проводит ряд трансформаций по приведению данных в матричный вид. <br>

![Скрин диспетчерской сводки](https://github.com/romanoffnv/DC_JSON/blob/main/Dispatch%202023-08-17%20082034.png?raw=true)

#### src3_drvs_parse.py
Модуль принимает данные, полученные в <b>src_xlsx_get.py</b>, в виде датафрейма. Источник является выгрузкой из системы 1С, проходит ряд преобразований по приведению данных в матричный вид.

![Скрин выгрузки из 1С](https://github.com/romanoffnv/DC_JSON/blob/main/Drivers%202023-08-17%20082305.png?raw=true)

#### src3_drvs_validator.py
Модуль проводит валидацию гос.номеров автомобилей при помощи простейшей нейронной сети, обучаемой распределением весов и коэфициентов смещений вручную, извлеченных через общий модуль plates_parser.py. Валидация требуется так, как извлечение номерных знаков при помощи регулярного выражения в данном источнике не дает однозначных результатов, по причине присутствия в строках других данных, по структуре подходящих для отбора регулярным выражением. Более подробное описание кода и выводы в консоль можно посмотреть в [validator.ipynb](NOTEBOOKS/validator.ipynb)
#### uniplates.py
Модуль принимает 3 преобразованных датафрейма из _main.py и приводит колонки гос.номеров в унифицированный вид для последующего сопоставления 3х датафреймов и отбора нужных колонок данных, с целью формирования общего отчета.
#### user_report.py
Модуль принимает 3 преобразованных датафрейма, проводит сопоставление по гос.номерам и формирует консолидированную таблицу данных, которая возвращается обратно в _main.py, где выгружается в БД SQLite

### GUI
#### _main.py
Главный модуль управления компонентом GUI, собирает общий интерфейс
#### button_field.py
Модуль создает поле кнопок, возвращает в _main.py
#### screen_field.py
Модуль поле главного презентационного экрана, возвращает в _main.py
#### warning_field.py
Модуль поле дополнительного экрана для оповещений, возвращает в _main.py

### SRC
Папка содержит источники DEMO_CODE_dispatch, DEMO_CODE_drivers и файл базы данных data.db. Источники больших размеров отслеживаются системой LFS, их размер изменяется автономно, вне зависимости от коммитов и прогрессивно не увеличивает размер репозитория